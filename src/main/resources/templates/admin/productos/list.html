<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Productos</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700;900&family=Spline+Sans:wght@400;500;700&display=swap"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        /* Aseguramos que el contenedor principal ocupe toda la altura de la ventana */
        .main-container {
            display: flex;
            flex-direction: column; /* Coloca el footer al final */
            min-height: 100vh; /* Altura mínima de la ventana */
            background: linear-gradient(0.25turn, #bbc2c9, #d1d8db, #e6e9ea, #f3f5f6, #d7dfe5); /* Fondo con gradiente */
        }
        .content {
            flex: 1; /* Permite que el contenido ocupe el espacio restante */
            padding: 20px; /* Espaciado interno */
            color: #333; /* Color del texto oscuro para mayor legibilidad */
        }
        .info-box {
            background-color: #f8f9fa; /* Color de fondo claro para los cuadros de información */
            border-radius: 0.5rem; /* Bordes redondeados */
        }
        .table-container {
            background-color: #f8f9fa; /* Color de fondo claro para la tabla */
            border-radius: 0.5rem; /* Bordes redondeados */
        }
        .badge {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%; /* Opcional, ajusta según tu diseño */
        }
    </style>
</head>
<body style='font-family: "Spline Sans", "Noto Sans", sans-serif;'>

<!-- CONTENEDOR PRINCIPAL -->
<div class="main-container">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom border-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Hecho con Amor</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav" aria-controls="navbarNav"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="/index">
                            <i class="bi bi-house-door me-2"></i>Inicio
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/usuarios">
                            <i class="bi bi-people me-2"></i>Usuarios
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/categorias">
                            <i class="bi bi-tags me-2"></i>Categorías
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/productos">
                            <i class="bi bi-box-seam me-2"></i>Productos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/clientes">
                            <i class="bi bi-box-seam me-2"></i>Clientes
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-6 content">

        <!-- Encabezado -->
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-2xl font-bold text-gray-900">Lista de Productos</h1>
            <a th:href="@{/productos/nuevo}"
               class="px-4 py-2 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition">
                Crear nuevo Producto
            </a>
        </div>

        <!-- Cuadros de estadísticas -->
        <div class="flex flex-wrap gap-4 p-4 mb-6 rounded-lg border border-gray-200 info-box">
            <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-lg p-6">
                <p class="text-[#333] text-base font-medium leading-normal">Productos Totales</p>
                <p class="text-[#333] tracking-light text-2xl font-bold leading-tight" th:text="${totalProductos}">120</p>
            </div>
            <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-lg p-6">
                <p class="text-[#333] text-base font-medium leading-normal">Más Vendidos</p>
                <p class="text-[#333] tracking-light text-2xl font-bold leading-tight" th:text="${productoMasVendido}">Pastel de Chocolate</p>
            </div>

            <!-- Mayor Stock con carita feliz -->
            <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-lg p-6 bg-green-100">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                    </svg>
                    <p class="text-green-800 text-base font-medium leading-normal">Más Stock</p>
                </div>
                <p class="text-green-900 tracking-light text-2xl font-bold leading-tight" th:text="${productoMasStock}">Magdalenas de Vainilla</p>
            </div>

            <!-- Menor Stock con carita triste -->
            <div class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-lg p-6 bg-red-100">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9.172 14.828a4 4 0 015.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                    </svg>
                    <p class="text-red-800 text-base font-medium leading-normal">Menos Stock</p>
                </div>
                <p class="text-red-900 tracking-light text-2xl font-bold leading-tight" th:text="${productoMenosStock}">Tarta de Frutas</p>
            </div>
        </div>

        <!-- Buscador -->
        <form th:action="@{/productos}" method="get" class="px-4 py-3">
            <div class="flex rounded-xl bg-[#223649] overflow-hidden">
                <div class="pl-4 flex items-center text-[#90adcb]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                         viewBox="0 0 256 256">
                        <path
                                d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"/>
                    </svg>
                </div>
                <input type="text" name="filtro" th:value="${filtroProductos}"
                       class="flex-1 bg-[#223649] text-white px-4 focus:outline-none placeholder-[#90adcb]"
                       placeholder="Buscar por nombre...">
                <button type="submit" class="px-4 bg-[#314d68] text-white">Buscar</button>
            </div>
        </form>

        <!-- Tabla de productos -->
        <div class="overflow-x-auto border border-gray-200 rounded-lg shadow-sm table-container">
            <table class="min-w-full text-sm text-left text-gray-700">
                <thead class="bg-gray-50 text-xs uppercase font-medium text-gray-500">
                <tr>
                    <th scope="col" class="px-6 py-3">Imagen</th>
                    <th scope="col" class="px-6 py-3">Nombre</th>
                    <th scope="col" class="px-6 py-3">Descripción</th>
                    <th scope="col" class="px-6 py-3">Precio</th>
                    <th scope="col" class="px-6 py-3">Stock</th>
                    <th scope="col" class="px-6 py-3">Estado Stock</th>
                    <th scope="col" class="px-6 py-3">Categoría</th>
                    <th scope="col" class="px-6 py-3">Acciones</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="producto : ${productos}" class="border-b hover:bg-gray-50 transition">
                    <td class="px-6 py-4">
                        <img th:if="${producto.imagen}"
                             th:src="@{/productos/uploads/{filename}(filename=${producto.imagen})}"
                             alt="Imagen del producto"
                             class="w-16 h-16 object-cover rounded">
                    </td>
                    <td class="px-6 py-4 font-medium text-gray-900" th:text="${producto.nombre}">Nombre</td>
                    <td class="px-6 py-4 text-gray-600 line-clamp-2" th:text="${producto.descripcion}">Descripción</td>
                    <td class="px-6 py-4 text-gray-800">S/ <span th:text="${producto.precio}">0.00</span></td>
                    <td class="px-6 py-4" th:text="${producto.stock}">0</td>
                    <td>
                        <span th:if="${producto.categoria.nombre == 'Bocaditos' and producto.stock < 25}"
                              class="badge bg-warning text-dark">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M9.172 14.828a4 4 0 015.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                        <span th:if="${producto.categoria.nombre == 'Bocaditos' and producto.stock > 25}"
                              class="badge bg-success text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                        <span th:if="${producto.categoria.nombre == 'Individuales' and producto.stock < 5}"
                              class="badge bg-warning text-dark">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M9.172 14.828a4 4 0 015.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                        <span th:if="${producto.categoria.nombre == 'Individuales' and producto.stock > 5}"
                              class="badge bg-success text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                        <span th:if="${producto.categoria.nombre == 'Tortas' and producto.stock < 2}"
                              class="badge bg-warning text-dark">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M9.172 14.828a4 4 0 015.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                        <span th:if="${producto.categoria.nombre == 'Tortas' and producto.stock > 2}"
                              class="badge bg-success text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z" />
                            </svg>
                        </span>
                    </td>
                    <td class="px-6 py-4" th:text="${producto.categoria.nombre}">Categoría</td>
                    <td class="px-6 py-4 flex gap-2">
                        <a th:href="@{/productos/ver/{id}(id=${producto.idProducto})}"
                           class="px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600 transition">
                            Ver
                        </a>
                        <a th:href="@{/productos/editar/{id}(id=${producto.idProducto})}"
                           class="px-3 py-1 bg-yellow-400 text-white rounded text-xs hover:bg-yellow-500 transition">
                            Editar
                        </a>
                        <a th:href="@{/productos/eliminar/{id}(id=${producto.idProducto})}"
                           class="px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 transition">
                            Eliminar
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="bg-[#000000] text-white text-center py-4">
        <p>&copy; 2023 Dulce Delicia. Todos los derechos reservados.</p>
    </footer>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
